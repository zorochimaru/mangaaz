[{"D:\\Projects\\react\\mangaaz\\src\\containers\\AdminPanel\\AdminPanel.tsx":"1","D:\\Projects\\react\\mangaaz\\src\\containers\\AdminPanel\\pages\\NewManga.tsx":"2","D:\\Projects\\react\\mangaaz\\src\\App.tsx":"3","D:\\Projects\\react\\mangaaz\\src\\containers\\AdminPanel\\pages\\UserController.tsx":"4","D:\\Projects\\react\\mangaaz\\src\\components\\Sidebar.tsx":"5","D:\\Projects\\react\\mangaaz\\src\\HOC\\AuthGuard.tsx":"6","D:\\Projects\\react\\mangaaz\\src\\containers\\Home\\Home.tsx":"7","D:\\Projects\\react\\mangaaz\\src\\components\\AddChapter.tsx":"8","D:\\Projects\\react\\mangaaz\\src\\index.tsx":"9","D:\\Projects\\react\\mangaaz\\src\\containers\\MangaDetails\\MangaDetails.tsx":"10","D:\\Projects\\react\\mangaaz\\src\\config\\db.tsx":"11","D:\\Projects\\react\\mangaaz\\src\\containers\\Reader\\Reader.tsx":"12","D:\\Projects\\react\\mangaaz\\src\\components\\Auth.tsx":"13","D:\\Projects\\react\\mangaaz\\src\\models\\User.model.tsx":"14","D:\\Projects\\react\\mangaaz\\src\\types\\constants.tsx":"15","D:\\Projects\\react\\mangaaz\\src\\containers\\ModeratorPanel\\ModeratorPanel.tsx":"16","D:\\Projects\\react\\mangaaz\\src\\reportWebVitals.ts":"17","D:\\Projects\\react\\mangaaz\\src\\HOC\\AuthContext.tsx":"18"},{"size":1753,"mtime":1609943199271,"results":"19","hashOfConfig":"20"},{"size":7205,"mtime":1610407316236,"results":"21","hashOfConfig":"20"},{"size":3054,"mtime":1609944048228,"results":"22","hashOfConfig":"20"},{"size":315,"mtime":1609887548027,"results":"23","hashOfConfig":"20"},{"size":2590,"mtime":1609963801223,"results":"24","hashOfConfig":"20"},{"size":442,"mtime":1609882409805,"results":"25","hashOfConfig":"20"},{"size":2360,"mtime":1610405978425,"results":"26","hashOfConfig":"20"},{"size":4941,"mtime":1609965775697,"results":"27","hashOfConfig":"20"},{"size":500,"mtime":1609253924912,"results":"28","hashOfConfig":"20"},{"size":2342,"mtime":1610406004354,"results":"29","hashOfConfig":"20"},{"size":272,"mtime":1609256520416,"results":"30","hashOfConfig":"20"},{"size":333,"mtime":1609517404424,"results":"31","hashOfConfig":"20"},{"size":2788,"mtime":1609791461299,"results":"32","hashOfConfig":"20"},{"size":357,"mtime":1609791463276,"results":"33","hashOfConfig":"20"},{"size":104,"mtime":1609752425134,"results":"34","hashOfConfig":"20"},{"size":122,"mtime":1609837550267,"results":"35","hashOfConfig":"20"},{"size":425,"mtime":1609253924912,"results":"36","hashOfConfig":"20"},{"size":223,"mtime":1609771994122,"results":"37","hashOfConfig":"20"},{"filePath":"38","messages":"39","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"40"},"e0dl8q",{"filePath":"41","messages":"42","errorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"43","messages":"44","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"45"},{"filePath":"46","messages":"47","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"48","messages":"49","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"50","messages":"51","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"52","messages":"53","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"54","messages":"55","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"56","usedDeprecatedRules":"57"},{"filePath":"58","messages":"59","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"60"},{"filePath":"61","messages":"62","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"63","messages":"64","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"65","messages":"66","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"67"},{"filePath":"68","messages":"69","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"70","messages":"71","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"72","messages":"73","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"74","messages":"75","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"76","messages":"77","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"78","messages":"79","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"D:\\Projects\\react\\mangaaz\\src\\containers\\AdminPanel\\AdminPanel.tsx",[],["80","81"],"D:\\Projects\\react\\mangaaz\\src\\containers\\AdminPanel\\pages\\NewManga.tsx",["82","83","84","85","86","87","88","89","90","91","92"],"D:\\Projects\\react\\mangaaz\\src\\App.tsx",[],["93","94"],"D:\\Projects\\react\\mangaaz\\src\\containers\\AdminPanel\\pages\\UserController.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\components\\Sidebar.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\HOC\\AuthGuard.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\containers\\Home\\Home.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\components\\AddChapter.tsx",["95","96","97"],"import { UploadOutlined } from \"@ant-design/icons\"\r\nimport { RouteComponentProps } from \"@reach/router\"\r\nimport { Upload, Button, Image, Select } from \"antd\"\r\nimport { Option } from \"antd/lib/mentions\";\r\nimport React, { useState } from \"react\"\r\nimport * as XLSX from 'xlsx';\r\nimport { ChapterPage } from \"../models/ChapterPage.model\";\r\nimport * as db from '../config/db';\r\n\r\nconst AddChapter: React.FC<RouteComponentProps | any> = () => {\r\n    const [pagesData, setPagesData] = useState<ChapterPage[]>([]);\r\n    const [fileList, setFileList] = useState<any>([]);\r\n    const [manga, setManga] = useState<any>(null);\r\n    const [error, setError] = useState(null);\r\n    const [isLoaded, setIsLoaded] = useState(false);\r\n    const [mangaList, setMangaList] = useState([]);\r\n\r\n    const readExel = (file: any) => {\r\n\r\n        const promise = new Promise<any[]>((resolve, reject) => {\r\n            const fileReader = new FileReader();\r\n            fileReader.readAsArrayBuffer(file);\r\n            fileReader.onload = (e: any) => {\r\n                const bufferArray = e.target.result;\r\n                const wb = XLSX.read(bufferArray, { type: 'buffer' });\r\n                const wsname = wb.SheetNames[0];\r\n                const ws = wb.Sheets[wsname];\r\n                const data = XLSX.utils.sheet_to_json(ws);\r\n                resolve(data);\r\n            };\r\n            fileReader.onerror = ((error) => {\r\n                reject(error);\r\n            });\r\n        });\r\n        promise.then((d) => {\r\n            const newList: ChapterPage[] = [];\r\n            d.forEach((element, i) => {\r\n                if (i > 0 && element.Id) {\r\n                    newList.push({\r\n                        id: element.Id,\r\n                        title: element.Title,\r\n                        owner: element.Owner,\r\n                        size: element.Size,\r\n                        googlePrev: element.URL,\r\n                        thumbnail: `https://drive.google.com/thumbnail?authuser=0&sz=w200&id=${element.Id}`,\r\n                        url: `https://drive.google.com/uc?export=view&id=${element.Id}`\r\n                    })\r\n                }\r\n            })\r\n\r\n            newList.sort((a: any, b: any) => {\r\n                if (a.title > b.title) {\r\n                    return 1;\r\n                }\r\n                if (a.title < b.title) {\r\n                    return -1;\r\n                }\r\n                // a должно быть равным b\r\n                return 0;\r\n            });\r\n            setPagesData(newList);\r\n        })\r\n    }\r\n\r\n    const uploadProps = {\r\n\r\n        multiple: false,\r\n        onRemove: () => {\r\n            setPagesData([]);\r\n            setFileList([]);\r\n            return false;\r\n        },\r\n        beforeUpload: (newFile: any) => {\r\n            readExel(newFile);\r\n            return false;\r\n        },\r\n        onChange: (info: any) => {\r\n            setFileList([]);\r\n            setFileList([info.file]);\r\n        },\r\n        fileList\r\n    }\r\n    const handleSearch = (value: string) => {\r\n        if (value) {\r\n\r\n            db.getDB('manga-library')\r\n                .collection('titles').find({ 'title': { $regex: `.*${value}.*` } }).asArray().then((mangaList: any) => {\r\n                    setIsLoaded(true);\r\n                    setMangaList(mangaList)\r\n                }).catch((err: any) =>\r\n                    setError(err)\r\n                )\r\n        } else {\r\n            setMangaList([]);\r\n        }\r\n    };\r\n\r\n    const handleChange = (value: string) => {\r\n        setManga(value);\r\n        console.log(value);\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Select\r\n                showSearch\r\n                style={{ width: 200 }}\r\n                placeholder=\"Select manga\"\r\n                filterOption={false}\r\n                notFoundContent={null}\r\n                onChange={handleChange}\r\n                onSearch={handleSearch}\r\n            >\r\n                {mangaList.map((d: any) => <Option key={d._id}>{d.title}</Option>)}\r\n            </Select>\r\n            <div style={{ width: 250, padding: 20 }}>\r\n                <Upload accept={'.csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel'}\r\n                    {...uploadProps}>\r\n                    <Button icon={<UploadOutlined />}>Select exel file</Button>\r\n                </Upload>\r\n            </div>\r\n            <Image.PreviewGroup>\r\n                {pagesData.map((page: any) => {\r\n                    return (\r\n                        <Image\r\n                            key={page.id}\r\n                            width={100}\r\n                            src={page.thumbnail}\r\n                            preview={{\r\n                                src: page.url,\r\n                            }}\r\n                        />\r\n                    )\r\n                })}\r\n            </Image.PreviewGroup>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AddChapter",["98","99"],"D:\\Projects\\react\\mangaaz\\src\\index.tsx",[],["100","101"],"D:\\Projects\\react\\mangaaz\\src\\containers\\MangaDetails\\MangaDetails.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\config\\db.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\containers\\Reader\\Reader.tsx",[],["102","103"],"D:\\Projects\\react\\mangaaz\\src\\components\\Auth.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\models\\User.model.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\types\\constants.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\containers\\ModeratorPanel\\ModeratorPanel.tsx",[],"D:\\Projects\\react\\mangaaz\\src\\reportWebVitals.ts",[],"D:\\Projects\\react\\mangaaz\\src\\HOC\\AuthContext.tsx",[],{"ruleId":"104","replacedBy":"105"},{"ruleId":"106","replacedBy":"107"},{"ruleId":"108","severity":1,"message":"109","line":3,"column":19,"nodeType":"110","messageId":"111","endLine":3,"endColumn":25},{"ruleId":"108","severity":1,"message":"112","line":4,"column":8,"nodeType":"110","messageId":"111","endLine":4,"endColumn":15},{"ruleId":"108","severity":1,"message":"113","line":19,"column":10,"nodeType":"110","messageId":"111","endLine":19,"endColumn":15},{"ruleId":"108","severity":1,"message":"114","line":19,"column":17,"nodeType":"110","messageId":"111","endLine":19,"endColumn":25},{"ruleId":"108","severity":1,"message":"115","line":20,"column":10,"nodeType":"110","messageId":"111","endLine":20,"endColumn":16},{"ruleId":"108","severity":1,"message":"116","line":20,"column":18,"nodeType":"110","messageId":"111","endLine":20,"endColumn":27},{"ruleId":"108","severity":1,"message":"117","line":21,"column":10,"nodeType":"110","messageId":"111","endLine":21,"endColumn":17},{"ruleId":"108","severity":1,"message":"118","line":51,"column":12,"nodeType":"110","messageId":"111","endLine":51,"endColumn":24},{"ruleId":"119","severity":1,"message":"120","line":123,"column":32,"nodeType":"121","messageId":"122","endLine":123,"endColumn":34},{"ruleId":"119","severity":1,"message":"120","line":135,"column":44,"nodeType":"121","messageId":"122","endLine":135,"endColumn":46},{"ruleId":"108","severity":1,"message":"123","line":146,"column":9,"nodeType":"110","messageId":"111","endLine":146,"endColumn":17},{"ruleId":"104","replacedBy":"124"},{"ruleId":"106","replacedBy":"125"},{"ruleId":"108","severity":1,"message":"113","line":13,"column":12,"nodeType":"110","messageId":"111","endLine":13,"endColumn":17},{"ruleId":"108","severity":1,"message":"126","line":14,"column":12,"nodeType":"110","messageId":"111","endLine":14,"endColumn":17},{"ruleId":"108","severity":1,"message":"127","line":15,"column":12,"nodeType":"110","messageId":"111","endLine":15,"endColumn":20},{"ruleId":"104","replacedBy":"128"},{"ruleId":"106","replacedBy":"129"},{"ruleId":"104","replacedBy":"130"},{"ruleId":"106","replacedBy":"131"},{"ruleId":"104","replacedBy":"132"},{"ruleId":"106","replacedBy":"133"},"no-native-reassign",["134"],"no-negated-in-lhs",["135"],"@typescript-eslint/no-unused-vars","'Upload' is defined but never used.","Identifier","unusedVar","'ImgCrop' is defined but never used.","'manga' is assigned a value but never used.","'setManga' is assigned a value but never used.","'errors' is assigned a value but never used.","'setErrors' is assigned a value but never used.","'loading' is assigned a value but never used.","'beforeUpload' is defined but never used.","array-callback-return","Array.prototype.map() expects a return value from arrow function.","ArrowFunctionExpression","expectedInside","'normFile' is assigned a value but never used.",["134"],["135"],"'error' is assigned a value but never used.","'isLoaded' is assigned a value but never used.",["134"],["135"],["134"],["135"],["134"],["135"],"no-global-assign","no-unsafe-negation"]